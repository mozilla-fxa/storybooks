issue #5745: lots of rework and deletion
